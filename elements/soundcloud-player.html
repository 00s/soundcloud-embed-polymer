<link rel="import" href="../bower_components/polymer/polymer.html">

<polymer-element name="soundcloud-player" attributes="track-id color auto-play show-artwork">
  <template>
    <style>
      :host .soundcloud-embed {
        border: none;
        overflow: hidden;
        width: 100%;
        height: 166px;
      }
    </style>

    <iframe class="soundcloud-embed" src="{{ playerUrl }}"></iframe>
  </template>

  <script>
    Polymer('soundcloud-player', {
      "color": 'ff6600',
      "auto-play": false,
      "show-artwork": true,

      ready: function() {
        if (!this["track-id"]) {
          throw new Error("SoundCloud player requires a `trackid` value.");
        }
        this.playerUrl = this.getPlayerUrl();
      },

      getPlayerUrl: function() {
        var params = {
          url: "https://api.soundcloud.com/tracks/" + this["track-id"],
          color: this.color,
          auto_play: this["auto-play"],
          show_artwork: this["show-artwork"]
        };
        var paramPairs = [];
        for(var key in params) {
          paramPairs.push(key + "=" + encodeURIComponent(params[key]));
        }
        return "https://w.soundcloud.com/player/?" + paramPairs.join("&amp;");
      }
    });
  </script>
</polymer-element>
