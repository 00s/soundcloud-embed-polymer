<link rel="import" href="../bower_components/polymer/polymer.html">

<polymer-element name="soundcloud-player" attributes="trackid color autoplay showartwork">
  <template>
    <style>
      :host .soundcloud-embed {
        border: none;
        overflow: hidden;
        width: 100%;
        height: 166px;
      }
    </style>

    <iframe class="soundcloud-embed" src="{{ playerurl }}"></iframe>
  </template>

  <script>
    Polymer('soundcloud-player', {
      color: 'ff6600',
      autoplay: false,
      showartwork: true,

      ready: function() {
        if (!this.trackid) {
          throw new Error("SoundCloud player requires a `trackid` value.");
        }
        this.playerurl = this.getPlayerUrl();
      },

      getPlayerUrl: function() {
        var params = {
          url: "https://api.soundcloud.com/tracks/" + this.trackid,
          color: this.color,
          auto_play: this.autoplay,
          show_artwork: this.showartwork
        };
        var paramPairs = [];
        for(var key in params) {
          paramPairs.push(key + "=" + encodeURIComponent(params[key]));
        }
        return "https://w.soundcloud.com/player/?" + paramPairs.join("&amp;");
      }
    });
  </script>
</polymer-element>
